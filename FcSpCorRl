import math
from array import *
import random


# New Coordinates Unchanged / Новые Координаты Неизмененные

def NCUnc(lt0, ln0, alt0, V, Vh, direction, T):

    # Радиус Земли в километрах
    R = 6371.0

    # Начальные координаты; для тестов; заменить на ввод в фунции
    #lt0 = 55.7558                                           # Широта
    #ln0 = 37.6176                                           # Долгота
    #alt0 = 150.0                                            # Высота
    
    # Начальные параметры перемещения; для тестов; заменить на ввод в фунции
    #V = 100                                                 # Горизонтальная скорость в км/ч
    #Vh = 5                                                  # Вертикальная скорость в км/ч
    #direction = 45                                          # Направление в градусах
    #T = 1                                                   # Время в часах

    # Перевод направления в радианы из градусов
    dr = math.radians(direction)

    # Перевод широты в радианы
    lt1 = math.radians(lt0)

    # Расчет изменений в широте и долготе
    dlt = (V * T * math.cos(dr)) / R                        # Широта
    dln = (V * T * math.sin(dr)) / (R * math.cos(lt1))      # Долгота

    # Расчет изменений в высоте
    dalt = Vh * T * 1000  # Расчет изменений и перевод из километры в метры

    # Новые координаты в радианах
    ltrn = lt1 + dlt                                        # Широта
    lnrn = math.radians(ln0) + dln                          # Долгота

    # Перевод новых координат обратно в градусы 
    LT = math.degrees(ltrn)                                 # Широта
    LN = math.degrees(lnrn)                                 # Долгота
    ALT = alt0 + dalt                                       # Высота

    # Массив с новыми координатами
    NC = [LT, LN, ALT]

    return NC
