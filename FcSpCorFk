import math
from array import *
import random


# New Coordinates Altered / Новые Координаты Измененные

def NCAlt(lt0, ln0, alt0, V, Vh, direction, T):

    # Радиус Земли в километрах
    R = 6371.0

    # Начальные координаты; для тестов; заменить на ввод в фунции
    #lt0 = 55.7558                                           # Широта
    #ln0 = 37.6176                                           # Долгота
    #alt0 = 150.0                                            # Высота
    
    # Начальные параметры перемещения; для тестов; заменить на ввод в фунции
    #V = 100                                                 # Горизонтальная скорость в км/ч
    #Vh = 5                                                  # Вертикальная скорость в км/ч
    #direction = 45                                          # Направление в градусах
    #T = 1                                                   # Время в часах


    # Проверка что скорость по горизонтали не нулевая, чтобы могло произойти смещение координат
    if V == 0:
        V = 4
    
    # Новая измененная скорость по горизонтали для подмены в рачетах конечного положения
    V = V * random.uniform(0.8, 1.2)


    # Проверка что скорость по вертикали не нулевая, чтобы могло произойти смещение координат
    if Vh == 0:
        Vh = 1

    # Новая измененная скорость по горизонтали для подмены в рачетах конечного положения
    Vh = Vh * random.uniform(0.8, 1.2)


    # Случайный выбор знака
    #rd = random.choice([-1, 1])


    # Новое направление для подмены в рачетах конечного положения
    direction = direction + random.uniform(-15, 15)



    # Перевод направления в радианы из градусов
    dr = math.radians(direction)

    # Перевод широты в радианы
    lt1 = math.radians(lt0)

    # Расчет изменений в широте и долготе
    dlt = (V * T * math.cos(dr)) / R                        # Широта
    dln = (V * T * math.sin(dr)) / (R * math.cos(lt1))      # Долгота

    # Расчет изменений в высоте
    dalt = Vh * T * 1000  # Расчет изменений и перевод из километры в метры

    # Новые координаты в радианах
    ltrn = lt1 + dlt                                        # Широта
    lnrn = math.radians(ln0) + dln                          # Долгота

    # Перевод новых координат обратно в градусы 
    LT = math.degrees(ltrn)                                 # Широта
    LN = math.degrees(lnrn)                                 # Долгота
    ALT = alt0 + dalt                                       # Высота

    # Массив с новыми координатами
    NC = [LT, LN, ALT, V, Vh, direction]

    return NC
